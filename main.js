(()=>{"use strict";class e{constructor(){this.columnTodo=document.querySelector(".todo"),this.columnInProgress=document.querySelector(".in_progress"),this.columnDone=document.querySelector(".done")}static renderTask(e,t){const o=document.createElement("DIV"),n=document.createElement("P");o.classList.add("task"),n.classList.add("task_text"),n.textContent=t,e.querySelector(".add_card").parentNode.insertBefore(o,e.querySelector(".add_card")),o.prepend(n)}defaultContent(){return[]}actionDefault(){this.defaultContent().forEach((t=>{e.renderTask(this.columnTodo,t)}))}actionStorage(t){this.defaultContent().forEach((t=>{e.renderTask(this.columnTodo,t)})),t.toDo.forEach((t=>{e.renderTask(this.columnTodo,t)})),t.inProgress.forEach((t=>{e.renderTask(this.columnInProgress,t)})),t.done.forEach((t=>{e.renderTask(this.columnDone,t)}))}}const t=new e,o=new class{constructor(){this.storage=localStorage}save(e){this.storage.setItem("dataTrello",JSON.stringify(e))}load(){try{return JSON.parse(this.storage.getItem("dataTrello"))}catch(e){throw new Error("Invalid data")}}statusChange(e,t){const o=this.load();for(const n in o)n===e&&(o[n].status=t);this.save(o)}remove(){let e=this.load();e={},this.save(e)}},n=o.load(),s={};let c,r=0,l=0;function d(){const e=Array.from(document.querySelector(".todo").querySelectorAll(".task_text")),t=Array.from(document.querySelector(".in_progress").querySelectorAll(".task_text")),n=Array.from(document.querySelector(".done").querySelectorAll(".task_text"));s.toDo=[],s.inProgress=[],s.done=[],e.forEach((e=>{s.toDo.push(e.textContent)})),t.forEach((e=>{s.inProgress.push(e.textContent)})),n.forEach((e=>{s.done.push(e.textContent)})),o.save(s)}null===n||void 0===n.toDo?t.actionDefault():t.actionStorage(n);const a=e=>{const{target:t}=e,{pageX:o,pageY:n}=e;if(c.style.top=n-l+"px",c.style.left=o-r+"px",t.classList.contains("task")||t.classList.contains("title")){const{y:o,height:n}=t.getBoundingClientRect(),s=function(e){const t=document.createElement("div"),{width:o,height:n}=e.getBoundingClientRect();return t.classList.add("shadow_element"),t.style.width=`${o}px`,t.style.height=`${n}px`,d(),t}(document.querySelector(".dragged"));let c;o+n/2>e.clientY&&!t.classList.contains("title")&&(document.querySelector(".shadow_element")&&document.querySelector(".shadow_element").remove(),c=e.target.previousElementSibling.closest(".task")||e.target.previousElementSibling.closest("h1"),c&&c.insertAdjacentElement("afterend",s)),o+n/2<e.clientY&&(document.querySelector(".shadow_element")&&document.querySelector(".shadow_element").remove(),c=e.target.nextElementSibling.closest(".task")||e.target.nextElementSibling.closest(".add_card"),c&&c.insertAdjacentElement("beforebegin",s))}},u=e=>{const t=e.targetTouches[0],{target:o}=e;c.style.top=e.clientY-l+"px",c.style.left=e.clientX-r+"px",t.pageX+20<o.closest(".column").offsetLeft&&o.closest(".task").remove()};document.querySelectorAll(".add_card").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),function(e){const t=document.createElement("div"),o=document.createElement("textarea"),n=document.createElement("button"),s=document.createElement("span");t.classList.add("form"),o.classList.add("textarea_task"),n.classList.add("button_add"),s.classList.add("span_closed"),n.textContent="Add Card",s.textContent="╳",e.closest(".column").appendChild(t),t.prepend(s),t.prepend(n),t.prepend(o);const c=()=>{t.closest(".column").appendChild(e),t.remove(t)};s.addEventListener("click",c),n.addEventListener("click",(()=>{const e=document.createElement("DIV");e.classList.add("task"),t.closest(".column").appendChild(e);const n=document.createElement("P");n.classList.add("task_text"),n.textContent=o.value,e.prepend(n),c()}))}(e),e.remove(e),d()}))}));const m=e=>{const t=e.target.closest(".task");if(t){const e=t.closest(".column"),o=function(){const e=document.createElement("div");return e.classList.add("closed_element"),e.textContent="╳",d(),e}(),{width:n}=t.getBoundingClientRect();o.style.top=`${t.offsetTop+2}px`,o.style.left=n+t.offsetLeft-17+"px",e.querySelector(".closed_element")||(o.addEventListener("click",(()=>{t.remove(),o.remove(),d()})),e.insertAdjacentElement("afterbegin",o))}document.querySelector(".closed_element")&&!t&&e.target!==document.querySelector(".closed_element")&&document.querySelector(".closed_element").remove()},i=e=>{const t=e.target.closest(".column");if(e.target.classList.contains("shadow_element")){const e=t.querySelector(".shadow_element");t.insertBefore(c,e)}c.style.width=null,c.style.height=null,c.style.top=null,c.style.left=null,c.classList.remove("dragged"),c=void 0,o.save(s),d(),document.querySelector(".shadow_element")&&document.querySelector(".shadow_element").remove(),document.documentElement.removeEventListener("mousemove",a),document.documentElement.removeEventListener("mouseup",i),document.documentElement.removeEventListener("touchmove",u),document.documentElement.removeEventListener("touchend",i),document.addEventListener("mousemove",m),document.addEventListener("touchmove",m),document.documentElement.style.cursor="auto"};document.addEventListener("mousemove",m),document.addEventListener("touchmove",m);const h=Array.from(document.querySelectorAll(".column"));h.forEach((e=>e.addEventListener("mousedown",(e=>{const{target:t}=e;if(t.closest(".task")){e.preventDefault(),c=t.closest(".task");const{width:o,height:n}=c.getBoundingClientRect();c.classList.add("dragged"),document.documentElement.style.cursor="grabbing",document.removeEventListener("mousemove",m),document.querySelector(".closed_element")&&document.querySelector(".closed_element").remove(),r=e.offsetX,l=e.offsetY,c.style=`\n\t\t \t\tleft: ${e.pageX-r}px;\n\t\t \t\ttop: ${e.pageY-l}px;\n                width: ${o}px;\n                height: ${n}px;\n\t\t\t`,document.documentElement.addEventListener("mousemove",a),document.documentElement.addEventListener("mouseup",i)}})))),h.forEach((e=>e.addEventListener("touchstart",(e=>{if(e.target.closest(".task")){e.preventDefault(),c=e.target.closest(".task");const{width:t,height:o}=c.getBoundingClientRect();c.classList.add("dragged"),document.removeEventListener("touchmove",m),document.querySelector(".closed_element")&&document.querySelector(".closed_element").remove(),c.style.width=`${t}px`,c.style.height=`${o}px`,document.documentElement.addEventListener("touchmove",u),document.documentElement.addEventListener("touchend",i)}}))))})();
//# sourceMappingURL=main.js.map